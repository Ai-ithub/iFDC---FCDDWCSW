## مقدمه

فرآیند پیش‌پردازش داده و تولید داده‌های تکمیلی در این مرحله به‌طور کامل انجام شده است. هدف اصلی این بخش، آماده‌سازی داده‌های خام برای استفاده در مدل‌های یادگیری ماشین و تحلیل‌های بعدی بوده است.

در این مرحله:
- اصلاح فایل تولید داده ها.
- شناسایی ترکیب های ناسازگار و ذخیره سازی آنها.
- شناسایی داده های پرت و ذخیره سازی آنها.
- مقادیر گمشده در ستون‌های عددی با استفاده از مدل‌های پیش‌بینی (CatBoostRegressor) تخمین زده شدند.
- نرمال‌سازی داده‌ها برای افزایش دقت مدل‌ها و یکپارچه‌سازی مقیاس متغیرها انجام شد.
- پارامترهای نرمال‌سازی (میانگین، انحراف معیار) ذخیره شدند تا در مراحل بعدی مانند inference یا pipeline production مورد استفاده قرار گیرند.

نتایج حاصل از این مراحل در ادامه گزارش به همراه کدهای مربوطه ارائه شده‌اند.
## شناسایی ترکیب‌های ناسازگار

در این مرحله، ترکیب‌هایی از ویژگی‌ها که به‌صورت منطقی یا فنی با یکدیگر ناسازگار بودند، شناسایی شدند. این ترکیب‌ها می‌توانند نشان‌دهنده ورود اشتباه داده، خطای اندازه‌گیری یا موارد غیرقابل قبول در فرآیندهای فنی باشند.

### مراحل انجام کار:
- یک لیست از ترکیب‌های ناسازگار بر اساس منطق دامنه تخصصی یا تحلیل آماری تهیه شد.
- داده‌هایی که شامل این ترکیب‌ها بودند، از دیتاست اصلی فیلتر شدند.
- این رکوردهای ناسازگار در یک فایل جداگانه به نام `invalid_combinations.parquet` ذخیره شدند تا در صورت نیاز قابل بررسی بیشتر یا مستندسازی باشند.
تعداد داده های ناسازگار: `601`
درصد داده های ناسازگار: `6.01%`
این گام کمک می‌کند تا کیفیت نهایی داده‌ها برای تحلیل و مدل‌سازی افزایش یابد و از ورود نویز به فرآیند یادگیری ماشین جلوگیری شود.
## شناسایی داده‌های پرت

برای بهبود کیفیت داده و جلوگیری از تأثیر مقادیر غیرواقعی بر نتایج مدل‌سازی، داده‌های پرت (Outliers) شناسایی و جداسازی شدند.

### روش‌های استفاده شده:
- **روش IQR (Interquartile Range):** با محاسبه فاصله بین چارک اول (Q1) و چارک سوم (Q3)، داده‌هایی که خارج از محدوده `[Q1 - 1.5*IQR, Q3 + 1.5*IQR]` بودند، به عنوان داده پرت در نظر گرفته شدند.
- **روش Z-Score:** داده‌هایی که مقدار نرمال‌شده آن‌ها (Z-score) از آستانه ±3 تجاوز می‌کردند، نیز به عنوان داده پرت شناسایی شدند.

### نتیجه:
- داده های پرت پیدا شده با روش IQR : `498 (4.98%)`
- داده های پرت پیدا شده با روش zscore : `480 (4.80%)`
- داده های پرت پیدا شده با هر دو روش: `498 (4.98%)`
- لیست داده‌های پرت به‌دست‌آمده از هر دو روش با یکدیگر تجمیع شدند.
- رکوردهای پرت استخراج‌شده در یک فایل جداگانه به نام `outliers.parquet` ذخیره گردیدند.

این مرحله برای اطمینان از سلامت آماری داده و حذف تأثیر مقادیر افراطی در آموزش مدل‌های یادگیری ماشین ضروری بوده است.

## تخمین داده‌های گمشده

برای تکمیل مقادیر گمشده در ستون‌های عددی، چندین الگوریتم رگرسیون مختلف مورد آزمایش قرار گرفتند، از جمله:

- **K-Nearest Neighbors (KNN)**
- **XGBoost Regressor**
- **LightGBM**
- **CatBoost Regressor**

پس از ارزیابی دقت پیش‌بینی هر مدل بر اساس میانگین خطای مطلق (MAE)، مدل **CatBoost** بهترین عملکرد را ارائه داد و برای ایمپیوتر کردن مقادیر گمشده انتخاب شد.

### پارامترهای استفاده‌شده در CatBoost:
- iterations = 500
- learning_rate = 0.01
- depth = 6
- loss_function = 'MAE'
- verbose=False
- random_seed = 42

### گزارش دقت برای ستون حاوی داده گمشده:

| ستون         | MAE         | میانگین مقدار واقعی | درصد خطا (%) |
|--------------|-------------|---------------------|---------------|
| Salinity_ppm | 64189.97    | 158188.72           | 40.58         |

مقادیر گمشده با استفاده از مدل آموزش‌دیده بر اساس سایر ویژگی‌های عددی موجود، تخمین زده شده و در مجموعه‌داده جایگزین شدند.
فایل نتیجه با نام `cleaned_without_missing.parquet` ذخیره شده است.
## نرمال‌سازی داده‌ها

برای آماده‌سازی داده‌ها جهت آموزش مدل‌های یادگیری ماشین، تمامی ستون‌های عددی نرمال‌سازی شدند. دو روش اصلی برای نرمال‌سازی مورد استفاده قرار گرفتند:

- **Standardization (Z-Score)**: تبدیل داده‌ها به میانگین صفر و انحراف معیار یک.
- **Min-Max Scaling**: مقیاس‌بندی داده‌ها به بازه [0, 1] (در صورت نیاز برای برخی مدل‌ها).
داده های نرمال شده در فایل `normalize_data.parquet` ذخیره شده اند
### ذخیره پارامترها

برای هر ستون عددی، پارامترهای نرمال‌سازی به‌صورت زیر ذخیره شدند:

- در حالت **Z-Score**: میانگین و انحراف معیار هر ستون
- در حالت **Min-Max**: مقدار کمینه (min) و بیشینه (max) هر ستون

این مقادیر در یک فایل JSON به نام `normalization_params.json` ذخیره شده‌اند تا در مرحله پیش‌بینی نیز از همان مقیاس استفاده شود و سازگاری مدل حفظ شود.

### مستندسازی فرآیند

برای هر ستون عددی:
- پارامترها استخراج شدند
- نرمال‌سازی اعمال شد
- نسخه‌ی نرمال‌شده داده‌ها جایگزین داده اصلی گردید (یا در نسخه‌ای جداگانه ذخیره شد)

با این کار، آماده‌سازی نهایی داده‌ها برای مدلسازی به‌صورت اصولی انجام شده است.

